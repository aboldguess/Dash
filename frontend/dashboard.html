<!DOCTYPE html>
<html lang="en">
<head>
  <!--
    Mini readme: User dashboard
    Main authenticated area including messaging and business tools such as CRM,
    projects, timesheets and leave requests. Applies a strict Content Security
    Policy and loads scripts/styles locally. All interactions are wired up in
    app.js to avoid inline scripts.
  -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' ws:;">
  <title>Dashboard - Dash</title>
  <!-- Browser tab icon -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <nav>
      <a href="dashboard.html" class="wordmark">Dash</a>
      <!-- Profile menu with navigation options -->
      <div class="profile">
        <img id="navAvatar" class="avatar profile-button" alt="Profile menu" />
        <ul id="profileMenu" class="profile-menu hidden">
          <li><a href="manage-profiles.html">Manage Profiles</a></li>
          <li><a href="learning-zone.html">Learning Zone</a></li>
          <li><a href="view-profile.html?id=me">View Profile Page</a></li>
          <li><a href="my-details.html">My Details</a></li>
          <li><a href="subscription.html">Subscription Details</a></li>
          <li id="manageUsersLink" class="hidden"><a href="admin.html">Manage Users</a></li>
          <li><a href="#" id="logoutLink">Sign out</a></li>
        </ul>
      </div>
    </nav>
  </header>

  <!-- Main layout with two sidebars -->
  <div class="main-layout">
    <!-- Left sidebar for selecting the active business tool -->
    <nav class="tool-sidebar">
      <ul>
        <li id="tool-messages" class="active">ðŸ’¬</li>
        <li id="tool-crm">CRM</li>
        <li id="tool-projects">Projects</li>
        <li id="tool-timesheets">TS</li>
        <li id="tool-leave">Leave</li>
        <li id="tool-recruit">HR</li>
        <li id="tool-social">Social</li>
      </ul>
    </nav>

    <!-- Contextual sidebar which changes based on the selected tool -->
    <aside class="context-sidebar" id="contextSidebar">
      <p><strong>Users</strong></p>
      <ul id="userList"></ul>
    </aside>

    <main class="content">
      <!-- Messaging section -->
      <section id="messages">
        <h2>Instant Messages</h2>
        <label for="channelSelect">Channel:</label>
        <select id="channelSelect"></select>
        <!-- Chat container keeps message input pinned to bottom -->
        <div class="chat-container">
          <div id="messageList" class="message-list"></div>
          <div class="message-input">
            <input id="messageInput" placeholder="Message" />
            <button id="sendButton">Send</button>
          </div>
        </div>
      </section>

      <!-- Placeholder sections for future tools -->
      <section id="crm" class="hidden">
        <h2>CRM</h2>
        <form id="contactForm" class="card">
          <input id="contactId" type="hidden" />
          <input id="contactName" placeholder="Name" required />
          <input id="contactEmail" placeholder="Email" required />
          <input id="contactPhone" placeholder="Phone" required />
          <input id="contactCompany" placeholder="Company" />
          <input id="contactNotes" placeholder="Notes" />
          <button type="submit">Save</button>
          <span id="contactStatus" class="status"></span>
        </form>
        <table class="admin-table" id="contactTable"></table>
      </section>
      <section id="projects" class="hidden">
        <h2>Projects</h2>
        <form id="projectForm" class="card">
          <input id="projectId" type="hidden" />
          <input id="projectName" placeholder="Project name" required />
          <input id="projectOwner" placeholder="Owner" required />
          <input id="projectStart" type="date" />
          <input id="projectEnd" type="date" />
          <input id="projectHours" type="number" placeholder="Hours" />
          <input id="projectCost" type="number" placeholder="Â£ Cost" />
          <label><input id="projectBillable" type="checkbox" checked /> Billable</label>
          <textarea id="projectDesc" placeholder="Description"></textarea>
          <button type="submit">Save</button>
        </form>

        <div id="workPackageSection" class="hidden">
          <h3>Work Packages</h3>
          <form id="workPackageForm" class="card">
            <input id="wpProject" type="hidden" />
            <input id="wpId" type="hidden" />
            <input id="wpName" placeholder="Work package name" required />
            <input id="wpOwner" placeholder="Owner" />
            <input id="wpStart" type="date" />
            <input id="wpEnd" type="date" />
            <input id="wpHours" type="number" placeholder="Hours" />
            <input id="wpCost" type="number" placeholder="Â£ Cost" />
            <button type="submit">Save Work Package</button>
          </form>
          <table class="admin-table" id="workPackageTable"></table>

          <h4>Tasks</h4>
          <form id="taskForm" class="card">
            <input id="taskProject" type="hidden" />
            <input id="taskWp" type="hidden" />
            <input id="taskId" type="hidden" />
            <input id="taskName" placeholder="Task name" required />
            <input id="taskOwner" placeholder="Owner" />
            <input id="taskStart" type="date" />
            <input id="taskEnd" type="date" />
            <input id="taskHours" type="number" placeholder="Hours" />
            <input id="taskCost" type="number" placeholder="Â£ Cost" />
            <button type="submit">Save Task</button>
          </form>
          <table class="admin-table" id="taskTable"></table>
        </div>
        <div id="gantt"></div>
        <table class="admin-table" id="projectTable"></table>
      </section>
      <section id="timesheets" class="hidden">
        <h2>Timesheets</h2>
        <!-- Timesheet logging form and entries table -->
        <p>Record the hours you worked for a specific date.</p>
        <form id="timesheetForm" class="card">
          <input id="sheetId" type="hidden" />
          <label for="sheetProject">Project:</label>
          <select id="sheetProject"></select>
          <label for="sheetWp">Work Package:</label>
          <select id="sheetWp"></select>
          <label for="sheetTask">Task:</label>
          <select id="sheetTask"></select>
          <label for="sheetDate">Date:</label>
          <input id="sheetDate" type="date" required />
          <label for="sheetHours">Hours:</label>
          <input id="sheetHours" type="number" min="0" step="0.25" placeholder="Hours" required />
          <label><input id="sheetBillable" type="checkbox" checked /> Billable</label>
          <button type="submit">Save</button>
          <span id="timesheetStatus" class="status"></span>
        </form>
        <table class="admin-table" id="timesheetTable"></table>
      </section>
      <section id="leave" class="hidden">
        <h2>Leave Requests</h2>
        <p>Request time off and track approvals.</p>
        <form id="leaveForm" class="card">
          <input id="leaveId" type="hidden" />
          <label for="leaveStart">Start Date:</label>
          <input id="leaveStart" type="date" required />
          <label for="leaveEnd">End Date:</label>
          <input id="leaveEnd" type="date" required />
          <label for="leaveStatus" id="leaveStatusLabel" class="hidden">Status:</label>
          <select id="leaveStatus" class="hidden">
            <option value="pending">Pending</option>
            <option value="approved">Approved</option>
            <option value="rejected">Rejected</option>
          </select>
          <button type="submit">Save</button>
          <span id="leaveStatusMsg" class="status"></span>
        </form>
        <table class="admin-table" id="leaveTable"></table>
      </section>
      <section id="recruit" class="hidden">
        <h2>Recruitment</h2>
        <p>Recruitment functionality coming soon.</p>
      </section>
      <section id="social" class="hidden">
        <h2>Social</h2>
        <form id="postForm" class="card">
          <textarea id="postText" placeholder="Share an update" required></textarea>
          <button type="submit">Post</button>
        </form>
        <ul id="postList"></ul>
      </section>
    </main>
  </div>

  <!-- Socket.IO will be loaded dynamically if needed -->
  <script src="js/app.js"></script>
</body>
</html>
